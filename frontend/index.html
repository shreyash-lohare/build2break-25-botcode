<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to YouTube Shorts Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(to bottom, #f5e6d3, #ffffff);
            min-height: 100vh;
        }

        header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 1.5rem 0;
            position: relative;
        }

        .header-content {
            max-width: 56rem;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-info {
            flex: 1;
        }

        .header-api-btn {
            padding: 0.625rem 1.25rem;
            background: #0f172a;
            color: white;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: none;
        }

        .header-api-btn:hover {
            background: #1e293b;
        }

        .header-api-btn.show {
            display: inline-block;
        }

        h1 {
            font-size: 1.875rem;
            font-weight: bold;
            color: #0f172a;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #64748b;
        }

        main {
            max-width: 56rem;
            margin: 0 auto;
            padding: 3rem 1.5rem;
        }

        .progress-steps {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 3rem;
        }

        .step-circle {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all 0.3s;
        }

        .step-circle.active {
            background: #0f172a;
            color: white;
        }

        .step-circle.inactive {
            background: #e2e8f0;
            color: #94a3b8;
        }

        .step-line {
            width: 6rem;
            height: 0.25rem;
            margin: 0 1rem;
            transition: all 0.3s;
        }

        .step-line.active {
            background: #0f172a;
        }

        .step-line.inactive {
            background: #e2e8f0;
        }

        .notification {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            display: none;
            align-items: flex-start;
        }

        .notification.show {
            display: flex;
        }

        .notification.error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #991b1b;
        }

        .notification.success {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #166534;
        }

        .notification-icon {
            margin-right: 0.75rem;
            margin-top: 0.125rem;
        }

        .card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            padding: 2rem;
        }

        .card-header {
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 0.5rem;
        }

        .card-description {
            color: #64748b;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #334155;
            margin-bottom: 0.5rem;
        }

        input[type="password"],
        input[type="text"] {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: all 0.2s;
        }

        input:focus {
            outline: none;
            border-color: #0f172a;
            box-shadow: 0 0 0 3px rgba(15, 23, 42, 0.1);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-primary {
            background: #0f172a;
            color: white;
        }

        .btn-primary:hover {
            background: #1e293b;
        }

        .btn-primary.full-width {
            width: 100%;
            margin-top: 2rem;
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #334155;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .btn:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
        }

        .upload-area {
            border: 2px dashed #cbd5e1;
            border-radius: 0.5rem;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 2rem;
        }

        .upload-area:hover {
            border-color: #94a3b8;
            background: #f8fafc;
        }

        .upload-area.has-file {
            border-color: #0f172a;
            background: #f8fafc;
        }

        .upload-icon {
            font-size: 3rem;
            color: #94a3b8;
            margin-bottom: 1rem;
        }

        .upload-text {
            color: #0f172a;
            font-weight: 500;
            font-size: 1.125rem;
            margin-bottom: 0.25rem;
        }

        .upload-subtext {
            color: #64748b;
            font-size: 0.875rem;
        }

        .button-group {
            display: flex;
            gap: 1rem;
        }

        .button-group .btn {
            flex: 1;
        }

        .info-box {
            margin-top: 2rem;
            padding: 1rem;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
        }

        .info-title {
            font-size: 0.875rem;
            font-weight: 500;
            color: #0f172a;
            margin-bottom: 0.5rem;
        }

        .info-list {
            list-style: none;
            font-size: 0.875rem;
            color: #64748b;
        }

        .info-list li {
            margin-bottom: 0.25rem;
        }

        footer {
            max-width: 56rem;
            margin: 0 auto;
            padding: 2rem 1.5rem;
            text-align: center;
            color: #64748b;
            font-size: 0.875rem;
        }

        .hidden {
            display: none;
        }

        .spinner {
            display: inline-block;
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .video-container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto 2rem;
            border-radius: 0.5rem;
            overflow: hidden;
            background: #000;
        }

        .video-container video {
            width: 100%;
            display: block;
        }

        .download-section {
            text-align: center;
            margin-top: 2rem;
        }

        .video-info {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 2rem;
        }

        .video-info p {
            color: #64748b;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .video-info p:last-child {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="header-info">
                <h1>PDF to YouTube Shorts</h1>
                <p class="subtitle">Transform your PDFs into engaging animated video summaries</p>
            </div>
            <button class="header-api-btn" id="header-api-btn" onclick="changeApiKeys()">Change API Keys</button>
        </div>
    </header>

    <main>
        <!-- Progress Steps -->
        <div class="progress-steps">
            <div class="step-circle active" id="step1-circle">1</div>
            <div class="step-line inactive" id="step-line1"></div>
            <div class="step-circle inactive" id="step2-circle">2</div>
            <div class="step-line inactive" id="step-line2"></div>
            <div class="step-circle inactive" id="step3-circle">3</div>
        </div>

        <!-- Notifications -->
        <div class="notification error" id="error-notification">
            <span class="notification-icon">⚠️</span>
            <span id="error-message"></span>
        </div>

        <div class="notification success" id="success-notification">
            <span class="notification-icon">✓</span>
            <span id="success-message"></span>
        </div>

        <!-- Step 1: API Configuration -->
        <div class="card" id="step1">
            <div class="card-header">
                <h2 class="card-title">Configure API Keys</h2>
                <p class="card-description">Enter your API credentials to enable video generation</p>
            </div>

            <div class="form-group">
                <label for="gemini-api">Google Gemini API Key</label>
                <input type="password" id="gemini-api" placeholder="Enter your Gemini API key">
            </div>

            <div class="form-group">
                <label for="supabase-api">Supabase API Key</label>
                <input type="password" id="supabase-api" placeholder="Enter your Supabase API key">
            </div>

            <div class="form-group">
                <label for="elevenlabs-api">ElevenLabs API Key</label>
                <input type="password" id="elevenlabs-api" placeholder="Enter your ElevenLabs API key">
            </div>

            <button class="btn btn-primary full-width" onclick="submitApis()">Continue to Upload</button>
        </div>

        <!-- Step 2: PDF Upload -->
        <div class="card hidden" id="step2">
            <div class="card-header">
                <h2 class="card-title">Upload PDF Document</h2>
                <p class="card-description">Select a PDF file to convert into an animated video summary</p>
            </div>

            <div class="upload-area" id="upload-area" onclick="document.getElementById('file-input').click()">
                <input type="file" id="file-input" accept=".pdf" style="display: none;" onchange="handleFileSelect(event)">
                <div id="upload-placeholder">
                    <div class="upload-icon">📄</div>
                    <p class="upload-text">Click to upload PDF</p>
                    <p class="upload-subtext">or drag and drop your file here</p>
                </div>
                <div id="file-info" class="hidden">
                    <div class="upload-icon">✓</div>
                    <p class="upload-text" id="file-name"></p>
                    <p class="upload-subtext" id="file-size"></p>
                    <p class="upload-subtext" style="margin-top: 1rem;">Click to change file</p>
                </div>
            </div>

            <button class="btn btn-primary full-width" id="generate-btn" onclick="generateVideo()" disabled>
                <span id="generate-text">Generate Video Summary</span>
                <span id="generate-loading" class="hidden">
                    <span class="spinner"></span>Processing...
                </span>
            </button>

            <div class="info-box">
                <h3 class="info-title">Processing Information</h3>
                <ul class="info-list">
                    <li>• Maximum PDF size: 20 MB</li>
                    <li>• Video duration: Under 60 seconds</li>
                    <li>• Style: Doodle and freehand animations</li>
                    <li>• Sources will be automatically cited</li>
                    <li>• Processing time may vary based on PDF complexity</li>
                </ul>
            </div>
        </div>

        <!-- Step 3: Video Result -->
        <div class="card hidden" id="step3">
            <div class="card-header">
                <h2 class="card-title">Video Generated Successfully</h2>
                <p class="card-description">Your PDF has been transformed into an animated video summary</p>
            </div>

            <div class="video-container">
                <video id="generated-video" controls>
                    <source src="" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>

            <div class="video-info">
                <p><strong>Video Details:</strong></p>
                <p>Duration: <span id="video-duration">--</span> seconds</p>
                <p>Format: MP4 (H.264)</p>
                <p>Style: Doodle and freehand animations</p>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="resetForNewVideo()">Generate Another Video</button>
                <button class="btn btn-primary" onclick="downloadVideo()">
                    Download Video
                </button>
            </div>
        </div>
    </main>

    <footer>
        <p>Build2Break Hackathon 2025 - Problem Statement 3</p>
    </footer>

    <script>
        let apis = {
            gemini: '',
            supabase: '',
            elevenlabs: ''
        };
        let selectedFile = null;
        let videoUrl = null;

        function showError(message) {
            const errorDiv = document.getElementById('error-notification');
            const errorMsg = document.getElementById('error-message');
            errorMsg.textContent = message;
            errorDiv.classList.add('show');
            setTimeout(() => errorDiv.classList.remove('show'), 5000);
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('success-notification');
            const successMsg = document.getElementById('success-message');
            successMsg.textContent = message;
            successDiv.classList.add('show');
            setTimeout(() => successDiv.classList.remove('show'), 3000);
        }

        function submitApis() {
            const gemini = document.getElementById('gemini-api').value;
            const supabase = document.getElementById('supabase-api').value;
            const elevenlabs = document.getElementById('elevenlabs-api').value;

            if (!gemini.trim() || !supabase.trim() || !elevenlabs.trim()) {
                showError('All API keys are required');
                return;
            }

            apis = { gemini, supabase, elevenlabs };
            
            // Update UI to step 2
            document.getElementById('step1').classList.add('hidden');
            document.getElementById('step2').classList.remove('hidden');
            document.getElementById('step1-circle').classList.remove('active');
            document.getElementById('step1-circle').classList.add('inactive');
            document.getElementById('step2-circle').classList.remove('inactive');
            document.getElementById('step2-circle').classList.add('active');
            document.getElementById('step-line1').classList.remove('inactive');
            document.getElementById('step-line1').classList.add('active');

            // Show header API button
            document.getElementById('header-api-btn').classList.add('show');

            showSuccess('API keys configured successfully');
        }

        function goToStep1() {
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step1').classList.remove('hidden');
            document.getElementById('step2-circle').classList.remove('active');
            document.getElementById('step2-circle').classList.add('inactive');
            document.getElementById('step1-circle').classList.remove('inactive');
            document.getElementById('step1-circle').classList.add('active');
            document.getElementById('step-line1').classList.remove('active');
            document.getElementById('step-line1').classList.add('inactive');

            // Hide header API button
            document.getElementById('header-api-btn').classList.remove('show');
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file && file.type === 'application/pdf') {
                // Check file size (20MB limit)
                const maxSize = 20 * 1024 * 1024; // 20MB in bytes
                if (file.size > maxSize) {
                    showError('PDF file size must be under 20 MB. Your file is ' + (file.size / 1024 / 1024).toFixed(2) + ' MB');
                    selectedFile = null;
                    event.target.value = ''; // Reset file input
                    return;
                }
                
                selectedFile = file;
                
                // Update UI
                document.getElementById('upload-placeholder').classList.remove('hidden');
                document.getElementById('file-info').classList.add('hidden');
                document.getElementById('file-name').textContent = file.name;
                document.getElementById('file-size').textContent = (file.size / 1024 / 1024).toFixed(2) + ' MB';
                document.getElementById('upload-area').classList.add('has-file');
                document.getElementById('generate-btn').disabled = false;
                
                // Show file info, hide placeholder
                document.getElementById('upload-placeholder').classList.add('hidden');
                document.getElementById('file-info').classList.remove('hidden');
            } else {
                showError('Please upload a valid PDF file');
                selectedFile = null;
            }
        }

        function generateVideo() {
            if (!selectedFile) {
                showError('Please upload a PDF file first');
                return;
            }

            const generateBtn = document.getElementById('generate-btn');
            const generateText = document.getElementById('generate-text');
            const generateLoading = document.getElementById('generate-loading');

            generateBtn.disabled = true;
            generateText.classList.add('hidden');
            generateLoading.classList.remove('hidden');

            // Simulate processing - replace with actual API call to n8n workflow
            setTimeout(() => {
                generateBtn.disabled = false;
                generateText.classList.remove('hidden');
                generateLoading.classList.add('hidden');
                
                // Simulate video generation (replace with actual video URL from your API)
                videoUrl = 'https://www.w3schools.com/html/mov_bbb.mp4'; // Demo video
                showVideoResult();
                
                // Here you would make your actual API call:
                // fetch('YOUR_N8N_WEBHOOK_URL', {
                //     method: 'POST',
                //     body: JSON.stringify({
                //         apis: apis,
                //         file: selectedFile
                //     })
                // }).then(response => response.json())
                //   .then(data => {
                //       videoUrl = data.videoUrl;
                //       showVideoResult();
                //   });
            }, 2000);
        }

        function showVideoResult() {
            // Hide step 2, show step 3
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.remove('hidden');
            
            // Update progress indicators
            document.getElementById('step2-circle').classList.remove('active');
            document.getElementById('step2-circle').classList.add('inactive');
            document.getElementById('step3-circle').classList.remove('inactive');
            document.getElementById('step3-circle').classList.add('active');
            document.getElementById('step-line2').classList.remove('inactive');
            document.getElementById('step-line2').classList.add('active');
            
            // Set video source
            const video = document.getElementById('generated-video');
            video.src = videoUrl;
            
            // Get video duration when metadata loads
            video.addEventListener('loadedmetadata', function() {
                document.getElementById('video-duration').textContent = Math.round(video.duration);
            });
            
            showSuccess('Video generated successfully!');
        }

        function downloadVideo() {
            if (!videoUrl) {
                showError('No video available to download');
                return;
            }
            
            // Create a temporary anchor element to trigger download
            const a = document.createElement('a');
            a.href = videoUrl;
            a.download = 'pdf-video-summary.mp4';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showSuccess('Video download started!');
        }

        function resetForNewVideo() {
            // Reset file selection
            selectedFile = null;
            videoUrl = null;
            document.getElementById('file-input').value = '';
            
            // Reset upload area
            document.getElementById('upload-placeholder').classList.remove('hidden');
            document.getElementById('file-info').classList.add('hidden');
            document.getElementById('upload-area').classList.remove('has-file');
            document.getElementById('generate-btn').disabled = true;
            
            // Go back to step 2
            document.getElementById('step3').classList.add('hidden');
            document.getElementById('step2').classList.remove('hidden');
            
            // Update progress indicators
            document.getElementById('step3-circle').classList.remove('active');
            document.getElementById('step3-circle').classList.add('inactive');
            document.getElementById('step2-circle').classList.remove('inactive');
            document.getElementById('step2-circle').classList.add('active');
            document.getElementById('step-line2').classList.remove('active');
            document.getElementById('step-line2').classList.add('inactive');
            
            // Keep header API button visible
        }

        function changeApiKeys() {
            // Go to step 1 to change API keys
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.add('hidden');
            document.getElementById('step1').classList.remove('hidden');
            
            // Update progress indicators
            document.getElementById('step2-circle').classList.remove('active');
            document.getElementById('step2-circle').classList.add('inactive');
            document.getElementById('step3-circle').classList.remove('active');
            document.getElementById('step3-circle').classList.add('inactive');
            document.getElementById('step1-circle').classList.remove('inactive');
            document.getElementById('step1-circle').classList.add('active');
            document.getElementById('step-line1').classList.remove('active');
            document.getElementById('step-line1').classList.add('inactive');
            document.getElementById('step-line2').classList.remove('active');
            document.getElementById('step-line2').classList.add('inactive');
            
            // Keep header API button hidden on step 1
        }

        function startOver() {
            // Reset everything
            selectedFile = null;
            videoUrl = null;
            
            // Reset form fields
            document.getElementById('gemini-api').value = '';
            document.getElementById('supabase-api').value = '';
            document.getElementById('elevenlabs-api').value = '';
            document.getElementById('file-input').value = '';
            
            // Reset upload area
            document.getElementById('upload-placeholder').classList.remove('hidden');
            document.getElementById('file-info').classList.add('hidden');
            document.getElementById('upload-area').classList.remove('has-file');
            document.getElementById('generate-btn').disabled = true;
            
            // Go back to step 1
            document.getElementById('step3').classList.add('hidden');
            document.getElementById('step1').classList.remove('hidden');
            
            // Update progress indicators
            document.getElementById('step3-circle').classList.remove('active');
            document.getElementById('step3-circle').classList.add('inactive');
            document.getElementById('step1-circle').classList.remove('inactive');
            document.getElementById('step1-circle').classList.add('active');
            document.getElementById('step-line1').classList.remove('active');
            document.getElementById('step-line1').classList.add('inactive');
            document.getElementById('step-line2').classList.remove('active');
            document.getElementById('step-line2').classList.add('inactive');
            
            // Hide header API button
            document.getElementById('header-api-btn').classList.remove('show');
        }

        // Drag and drop functionality
        const uploadArea = document.getElementById('upload-area');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#0f172a';
        });

        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            if (!selectedFile) {
                uploadArea.style.borderColor = '#cbd5e1';
            }
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'application/pdf') {
                // Check file size before processing
                const maxSize = 20 * 1024 * 1024; // 20MB
                if (file.size > maxSize) {
                    showError('PDF file size must be under 20 MB. Your file is ' + (file.size / 1024 / 1024).toFixed(2) + ' MB');
                    return;
                }
                document.getElementById('file-input').files = e.dataTransfer.files;
                handleFileSelect({ target: { files: [file] } });
            }
        });
    </script>
</body>
</html>
